<!doctype html>
<!-- The Time Machine GitHub pages theme was designed and developed by Jon Rohan, on Feb 7, 2012. -->
<!-- Follow him for fun. http://twitter.com/jonrohan. Tail his code on http://github.com/jonrohan -->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen"/>
  <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Weixin admin</title>
  <meta name="description" content="微信公众平台的辅助管理脚本">

  <meta name="viewport" content="width=device-width,initial-scale=1">

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">Weixin admin</h1>
    </header>
    <div id="container">
      <p class="tagline">微信公众平台的辅助管理脚本</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/wxy/weixin_admin/tarball/master" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/wxy/weixin_admin/zipball/master" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/wxy/weixin_admin" class="code">View Weixin admin on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
          <h1>
<a name="weixin_admin" class="anchor" href="#weixin_admin"><span class="octicon octicon-link"></span></a>weixin_admin</h1>

<p>微信公众平台的辅助管理脚本集</p>

<h2>
<a name="materialsphp" class="anchor" href="#materialsphp"><span class="octicon octicon-link"></span></a>materials.php</h2>

<p>用于通过海外微信公众管理平台获取微信推送的文章访问量数据。</p>

<h3>
<a name="%E9%9C%80%E8%A6%81%E7%9A%84%E6%A8%A1%E5%9D%97" class="anchor" href="#%E9%9C%80%E8%A6%81%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="octicon octicon-link"></span></a>需要的模块</h3>

<ul>
<li>curl</li>
<li>mysql</li>
</ul><h3>
<a name="%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F" class="anchor" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="octicon octicon-link"></span></a>使用方式</h3>

<ul>
<li>上传文件到WEB，浏览器直接运行，会显示一页（10个消息）的文章的访问数据信息</li>
<li>在URL后面加上参数 ?page=-1 可以显示全部页的所有文章的访问数据信息</li>
<li>也可以在显示一页后，点击页面尾部的链接来显示更多：

<ul>
<li>next page 显示下一页</li>
<li>next total page 显示剩余页面的</li>
<li>total page 显示*全部*页面的（包括当前已经显示的第一页）</li>
</ul>
</li>
</ul><h3>
<a name="%E9%85%8D%E7%BD%AE" class="anchor" href="#%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a>配置</h3>

<p>虽然可以直接修改materials.php，但是不建议这样做。可以修改materials_conf.php 其中设置的变量会覆盖materials.php里面全局设置。</p>

<p>主要需要设置的变量有：</p>

<ul>
<li>数据库设置

<ul>
<li>用于将访问数据记录到数据库中。如果不设置数据库配置，则忽略数据记录的动作。设置数据库，也可以提示两次更新间隔之间的数据变化幅度</li>
</ul>
</li>
<li>公众平台的管理员账号

<ul>
<li>可以将公众平台的管理员账号信息设置写入。如果不设置，则会在运行时通过HTTP认证方式提示输入账号信息，该信息会保持在浏览器内存中，直到关闭浏览器。</li>
</ul>
</li>
<li>服务器端用于记录COOKIE的文件夹

<ul>
<li>由于本脚本实际上是模拟了用户登录行为（通过CURL），所以需要在服务器端支持cookie信息的存储和读取，因此需要设置一个目录可以创建相应的文件创建和访问。</li>
<li>一般这个目录是 /tmp (Linux下)，当然根据你的PHP设置不同，也可能是其它目录，比如上载文件的临时目录。如果不设置，脚本会自动尝试使用上载文件的临时目录。</li>
</ul>
</li>
</ul><h3>
<a name="%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8" class="anchor" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8"><span class="octicon octicon-link"></span></a>数据库存储</h3>

<p>如果需要通过数据库存储访问数据，可以通过以下语句创建数据表（或参见database.sql），并如上设置数据库访问信息。</p>

<pre><code>CREATE TABLE `weixin_article` (
    `slave_user` varchar(32) not null default '',
    `appmsgid` int not null default 0,
    `itemidx` int not null default 1,
    `time` date not null default '0000-00-00',
    `img_url` varchar(250) not null default '',
    `title` varchar(100) not null default '',
    `desc` varchar(200) not null default '',
    `url` varchar(250) not null default '',
    `pageview` int not null default 0,
    `vistor` int not null default 0,
    `sent_date` int not null default 0,
    PRIMARY KEY `id` (`slave_user`,`appmsgid`,`itemidx`),
    KEY `time` (`time`),
    KEY `title` (`title`),
    KEY `pageview` (`pageview`),
    KEY `vistor` (`vistor`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;
</code></pre>
        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/wxy" class="avatar"><img src="https://secure.gravatar.com/avatar/31abbacb2638a080ab7a9c9c11f33632?s=30&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png" width="48" height="48"/></a> <a href="https://github.com/wxy">wxy</a> maintains <a href="https://github.com/wxy/weixin_admin">Weixin admin</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="https://pages.github.com/">GitHub Pages</a><br/>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/wxy/weixin_admin/tarball/master" class="tar">tar</a><a href="https://github.com/wxy/weixin_admin/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

  
</body>
</html>
